import React, { useState } from "react";
import {
  Navbar,
  Nav,
  Container,
  Form,
  FormControl,
  Button,
  Dropdown,
  Offcanvas,
} from "react-bootstrap";
import { Link, useNavigate, useLocation } from "react-router-dom";
import { FaUser, FaShoppingCart } from "react-icons/fa";
import CartDrawer from "../carrito/CartDrawer";
import { useCart } from "../../context/CartContext";
import { useAuth } from "../../context/AuthContext";
import "./AppNavbar.css"; 

const AppNavbar = () => {
  const navigate = useNavigate();
  const location = useLocation();
  const { user, logout } = useAuth();
  const { cart } = useCart();

  const [showCart, setShowCart] = useState(false);
  const [showMenu, setShowMenu] = useState(false);

  const handleCartOpen = () => setShowCart(true);
  const handleCartClose = () => setShowCart(false);
  const handleMenuClose = () => setShowMenu(false);
  const handleMenuOpen = () => setShowMenu(true);

  const handleLogout = async () => {
    await logout();
    navigate("/");
  };

  const userName = user?.user_metadata?.nombre || "Cuenta";

  // Función para determinar si una ruta está activa
  const isActive = (path) => {
    if (path === "/" && location.pathname === "/") return true;
    if (path !== "/" && location.pathname.startsWith(path)) return true;
    return false;
  };

  return (
    <>
      <Navbar bg="light" expand="lg" className="shadow-sm">
        <Container className="d-flex justify-content-between align-items-center">
          {/* Logo */}
          <Navbar.Brand as={Link} to="/" className="fw-bold text-primary">
            <svg width="185" height="36" viewBox="0 0 185 36" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_1701_3)">
              <path d="M10.4596 18.6162C10.4596 11.4725 14.567 6.40079 20.3027 6.40079C24.1141 6.40079 26.4812 8.6965 26.4812 11.547C26.4812 16.9146 19.5247 18.8398 15.6388 18.9143C15.8229 23.3567 17.3417 27.207 21.1159 27.207C24.0769 27.207 28.0724 24.3193 28.3683 23.543L28.8132 23.6175C28.8132 23.8763 24.5217 28.5401 19.0446 28.5401C13.5675 28.5401 10.4596 24.4683 10.4596 18.6204V18.6162ZM22.8933 10.8059C22.8933 9.51003 22.4857 7.17914 20.4517 7.21433C17.0851 7.21433 15.6408 13.0271 15.6408 18.1339C18.7115 18.0594 22.8933 15.95 22.8933 10.8038V10.8059Z" fill="white"/>
              <path d="M26.6674 6.95558V6.69682H29.7008C31.7038 6.69682 33.326 8.32182 33.326 10.3236C34.2137 8.21418 36.2125 6.32628 39.6536 6.32628C41.0958 6.32628 42.8359 6.77134 43.9823 7.99268C45.352 9.40032 45.4245 11.0274 45.4245 12.7311V24.9092C45.4245 27.9088 46.9039 28.2048 47.0529 28.2048V28.242H38.7638V28.2048C38.9128 28.2048 40.3922 27.9088 40.3922 24.9092V13.2113C40.3922 11.9155 40.355 10.249 39.6887 9.10223C39.2066 8.21418 38.4307 7.76911 37.5802 7.76911C35.8049 7.76911 33.4729 9.73153 33.326 13.6543V24.9072C33.326 27.9067 34.8055 28.2027 34.9545 28.2027V28.24H26.6654V28.2027C26.8144 28.2027 28.2938 27.9067 28.2938 24.9072V10.0648C28.2938 7.0301 26.8144 6.95558 26.6654 6.95558H26.6674Z" fill="white"/>
              <path d="M56.2317 6.77134V6.69682H62.8924V10.8059C63.6332 8.40048 65.2244 6.32628 68.146 6.32628C68.4378 6.32628 68.7502 6.36975 69.0378 6.42357C69.6565 6.54157 70.1055 7.07978 70.1055 7.71115V12.8408H70.031C69.9193 12.3233 69.4765 10.9529 68.7357 9.91577C68.2184 9.13743 67.4777 8.50813 66.4038 8.50813C64.6284 8.54539 63.1841 10.3215 62.8883 14.0248V24.9072C62.8883 27.9067 64.3677 28.2027 64.5167 28.2027V28.24H56.2276V28.2027C56.3766 28.2027 57.856 27.9067 57.856 24.9072V10.0648C57.856 7.0301 56.3766 6.76927 56.2276 6.76927L56.2317 6.77134Z" fill="white"/>
              <path d="M68.6819 18.6162C68.6819 11.4725 72.7892 6.40079 78.525 6.40079C82.3364 6.40079 84.7035 8.6965 84.7035 11.547C84.7035 16.9146 77.747 18.8398 73.8611 18.9143C74.0452 23.3567 75.564 27.207 79.3382 27.207C82.2991 27.207 84.2586 24.6898 84.5545 23.9115L84.629 23.986C84.629 24.2447 82.7419 28.5401 77.2649 28.5401C71.7878 28.5401 68.6799 24.4683 68.6799 18.6204L68.6819 18.6162ZM81.1135 10.8059C81.1135 9.51003 80.7059 7.17914 78.6719 7.21433C75.3053 7.21433 73.8611 13.0271 73.8611 18.1339C76.9317 18.0594 81.1135 15.95 81.1135 10.8038V10.8059Z" fill="white"/>
              <path d="M54.953 26.9917C54.953 26.9917 55.3441 26.9234 56.0455 26.4618C56.5897 26.1057 57.0718 25.6607 57.4898 25.1618L58.2057 24.3068C58.2057 24.3068 56.7035 27.2981 55.0606 27.6376" fill="white"/>
              <path d="M54.3819 27.0559C55.64 27.0559 56.7139 26.4266 57.0822 25.6855H57.1567C57.0077 26.3521 55.3813 28.4987 51.9031 28.4987C49.4242 28.4987 47.0198 27.5734 47.0198 24.1309V7.47309H45.2445V6.69475H47.0198V1.14491C48.013 1.14491 48.9379 1.43264 49.718 1.92946C51.1209 2.82373 52.052 4.39284 52.052 6.1793V6.69682H56.8629V7.47516H52.052V23.0607C52.052 25.3191 52.3852 27.058 54.384 27.058L54.3819 27.0559Z" fill="white"/>
              <path d="M48.9566 1.55478L49.1407 3.22118L47.1046 4.33073C46.9205 3.96019 47.1046 3.40541 46.9205 2.85064C46.577 1.82182 45.8321 1.49889 45.2548 1.37054V1C46.2646 1.03105 48.0316 1.07452 48.9545 1.55478H48.9566Z" fill="white"/>
              <path d="M59.4369 7.66767L59.6211 9.33408L57.8354 8.9594C57.6512 8.21831 57.4153 7.67596 56.5401 7.4793V6.92452C57.5498 6.95557 58.512 7.18742 59.4348 7.66975L59.4369 7.66767Z" fill="white"/>
              </g>
              <path d="M135.021 7.79378L142.63 7.79171L142.727 7.01751H135.021L134.636 7.7027L135.021 7.79378Z" fill="#F7DFCA"/>
              <path d="M90.7017 7.11067L90.8859 8.77707L88.9057 9.83695C88.7215 9.4664 88.8498 8.96131 88.6657 8.40653C88.3222 7.37771 87.7946 7.29491 87 7.29491V6.87261C88.0098 6.90366 89.7768 6.62835 90.6997 7.11067H90.7017Z" fill="white"/>
              <path d="M93.791 26.6521V32.5373C93.791 35.5347 95.2705 35.8328 95.4194 35.8328V35.8701H87.0931V35.8328C87.2421 35.8328 88.7215 35.5368 88.7215 32.5373V10.2903C88.7215 7.25557 90.4845 6.97818 90.3376 6.97818L90.8135 7.13758H91.4487C92.7647 7.13758 93.8303 8.20366 93.8303 9.52023C95.0511 7.44809 96.6403 6.62627 98.6391 6.62627C103.413 6.62627 106.521 10.9568 106.521 16.9538C106.521 22.9508 103.634 28.7263 97.8611 28.7263C96.0112 28.7263 94.6787 27.9127 93.791 26.6541V26.6521ZM97.1948 27.8734C99.3778 27.8734 101.339 24.5054 101.339 17.3596C101.339 10.2137 99.3405 7.77102 97.2693 7.77102C95.7898 7.77102 94.2711 9.40016 93.791 11.5841V25.2796C94.5318 26.946 95.6408 27.8713 97.1948 27.8713V27.8734Z" fill="white"/>
              <path d="M107.483 13.3623H107.371C107.63 10.3275 110.108 6.66146 115.623 6.66146C117.326 6.66146 119.471 7.032 120.988 8.43758C122.062 9.47468 122.764 11.1038 122.764 13.3974V25.1326C122.764 28.1322 124.243 28.4282 124.392 28.4282V28.4654H117.731V25.2072C116.918 26.8736 115.215 28.6869 112.107 28.6869C108.592 28.6869 106.187 26.65 106.187 23.282C106.187 18.7279 110.553 15.5089 117.731 15.3226V12.8054C117.731 11.435 117.435 10.104 116.695 9.1414C116.066 8.32786 115.066 7.84554 113.734 7.84554C110.108 7.84554 107.814 11.1763 107.481 13.3623H107.483ZM114.032 27.1344C116.585 27.1344 117.731 23.9134 117.731 23.3959V16.0285C113.845 16.1403 111.22 18.9908 111.22 22.9135C111.22 24.876 111.811 27.1344 114.032 27.1344Z" fill="white"/>
              <path d="M134.68 7.18105V7.10653H141.341V25.3189C141.341 28.3185 142.82 28.6145 142.969 28.6145V28.6518H134.68V28.6145C134.829 28.6145 136.308 28.3185 136.308 25.3189V10.4745C136.308 7.43981 134.829 7.17898 134.68 7.17898V7.18105ZM138.305 0C139.785 0 141.08 1.2586 141.08 2.81322C141.08 4.25605 139.785 5.55191 138.305 5.55191C136.826 5.55191 135.53 4.25605 135.53 2.81322C135.53 1.2586 136.788 0 138.305 0Z" fill="white"/>
              <path d="M154.068 13.3623H153.956C154.215 10.3275 156.694 6.66146 162.208 6.66146C163.911 6.66146 166.057 7.032 167.573 8.43758C168.647 9.47468 169.349 11.1038 169.349 13.3974V25.1326C169.349 28.1322 170.828 28.4282 170.977 28.4282V28.4654H164.317V25.2072C163.503 26.8736 161.8 28.6869 158.693 28.6869C155.177 28.6869 152.773 26.65 152.773 23.282C152.773 18.7279 157.139 15.5089 164.317 15.3226V12.8054C164.317 11.435 164.021 10.104 163.28 9.1414C162.651 8.32786 161.651 7.84554 160.319 7.84554C156.694 7.84554 154.399 11.1763 154.066 13.3623H154.068ZM160.617 27.1344C163.17 27.1344 164.317 23.9134 164.317 23.3959V16.0285C160.431 16.1403 157.805 18.9908 157.805 22.9135C157.805 24.876 158.397 27.1344 160.617 27.1344Z" fill="white"/>
              <path d="M171.275 28.4675V22.1373H171.387C171.608 23.3959 172.09 24.729 172.829 25.8013C173.829 27.0971 175.271 27.9852 177.344 27.9852C179.786 27.9852 180.969 26.4678 180.969 24.7642C180.969 23.2096 179.97 21.8764 178.341 20.6551L174.604 17.8046C172.422 16.1755 171.052 14.4739 171.052 12.3624C171.052 9.66099 172.902 6.62421 178.304 6.62421C179.914 6.62421 181.861 7.08169 183.156 7.25765C183.62 7.32182 183.965 7.7172 183.965 8.18711V11.9546H183.891C183.632 10.696 183.078 9.69618 182.337 8.9551C181.153 7.80828 179.599 7.32596 178.267 7.32596C175.863 7.32596 174.714 8.62182 174.714 9.88042C174.714 11.139 175.455 11.9898 177.119 13.2857L181.522 16.5812C183.63 18.1358 185 20.061 185 22.6527C185 26.5775 181.78 28.7242 177.23 28.7242C175.455 28.7242 172.161 28.4655 171.273 28.4655L171.275 28.4675Z" fill="white"/>
              <path d="M133.113 27.3124C133.113 27.3124 133.505 27.2441 134.206 26.7825C134.75 26.4264 135.232 25.9814 135.65 25.4825L136.366 24.6275C136.366 24.6275 134.864 27.6188 133.221 27.9583" fill="white"/>
              <path d="M132.542 27.3766C133.8 27.3766 134.874 26.7473 135.243 26.0062H135.317C135.168 26.6728 133.542 28.8194 130.064 28.8194C127.585 28.8194 125.18 27.8941 125.18 24.4516V7.79378H123.405V7.01544H125.18V1.46352C126.174 1.46352 127.098 1.75126 127.879 2.24808C129.281 3.14235 130.213 4.71146 130.213 6.49792V7.01544H135.023V7.79378H130.213V23.3793C130.213 25.6377 130.546 27.3766 132.544 27.3766H132.542Z" fill="white"/>
              <path d="M127.117 1.87548L127.301 3.54188L125.265 4.65143C125.081 4.28089 125.265 3.72611 125.081 3.17134C124.738 2.14251 123.993 1.81959 123.415 1.69124V1.3207C124.425 1.35175 126.192 1.39522 127.115 1.87548H127.117Z" fill="white"/>
              <path d="M151.984 27.3124C151.984 27.3124 152.375 27.2441 153.077 26.7825C153.621 26.4264 154.103 25.9814 154.521 25.4825L155.237 24.6275C155.237 24.6275 153.735 27.6188 152.092 27.9583" fill="white"/>
              <path d="M151.413 27.3766C152.671 27.3766 153.745 26.7473 154.114 26.0062H154.188C154.039 26.6728 152.413 28.8194 148.934 28.8194C146.456 28.8194 144.051 27.8941 144.051 24.4516V7.79378H142.276V7.01544H144.051V1.46352C145.044 1.46352 145.969 1.75126 146.749 2.24808C148.152 3.14235 149.083 4.71146 149.083 6.49792V7.01544H153.894V7.79378H149.083V23.3793C149.083 25.6377 149.416 27.3766 151.415 27.3766H151.413Z" fill="white"/>
              <path d="M145.988 1.87548L146.172 3.54188L144.136 4.65143C143.952 4.28089 144.136 3.72611 143.952 3.17134C143.608 2.14251 142.863 1.81959 142.286 1.69124V1.3207C143.296 1.35175 145.063 1.39522 145.986 1.87548H145.988Z" fill="white"/>
              <path d="M87.0021 6.87468C87.0021 6.87468 93.9897 5.86656 93.8303 9.52022L90.3376 7.93248L87.0021 6.87468Z" fill="white"/>
              <path d="M88.6678 8.40653L88.7485 11.5862L90.4948 10.7912L90.3376 8.72532L88.6678 8.40653Z" fill="white"/>
              <defs>
              <clipPath id="clip0_1701_3">
              <rect width="98" height="33" fill="white" transform="translate(0 3)"/>
              </clipPath>
              </defs>
            </svg>

          </Navbar.Brand>

          {/* Carrito + Burger en mobile */}
          <div className="d-flex align-items-center d-lg-none">
            <Nav.Link onClick={handleCartOpen} className="me-2">
              <FaShoppingCart size={20} />
              {cart.length > 0 && (
                <span className="ms-1 badge bg-danger rounded-pill">
                  {cart.length}
                </span>
              )}
            </Nav.Link>
            <Button
              variant="outline-secondary"
              onClick={handleMenuOpen}
              aria-label="Menú"
            >
              ☰
            </Button>
          </div>

          {/* Menú Desktop */}
          <Navbar.Collapse id="main-navbar" className="d-none d-lg-flex">
            <Nav className="mx-auto gap-5">
              <Nav.Link 
                as={Link} 
                to="/" 
                className={isActive("/") ? "sans-bold link-navbar" : "sans-regular link-navbar"}
              >
                Inicio
              </Nav.Link>
              <Nav.Link 
                as={Link} 
                to="/products" 
                className={isActive("/products") ? "sans-bold link-navbar" : "sans-regular link-navbar"}
              >
                Productos
              </Nav.Link>
            </Nav>

            {/* Carrito */}
            <Nav className="align-items-center me-3">
              <Nav.Link onClick={null} title="Carrito">
                <svg className="trash-icon" width="33" height="29" viewBox="0 0 33 29" fill="none" xmlns="http://www.w3.org/2000/svg">
                 <path d="M9.13191 1.00971C12.3715 0.995377 14.8682 3.02225 16.4026 5.67645C16.5588 5.71307 16.8048 5.1343 16.9092 4.98225C22.6172 -3.28287 33.6252 2.46737 31.7978 11.7467C30.9521 16.0401 26.4346 19.8224 23.2411 22.5952C21.417 24.1794 19.4261 25.9261 17.5324 27.4084C16.9942 27.8295 16.6332 28.2292 15.879 27.8447C11.716 23.8801 5.79843 20.2857 2.68265 15.4303C-1.01178 9.67287 1.48247 1.04235 9.13191 1.00971Z" stroke="white" stroke-miterlimit="10"/>
                </svg>
                {cart.length > 0 && (
                  <span className="ms-1 badge bg-danger rounded-pill">
                    {cart.length}
                  </span>
                )}
              </Nav.Link>
              <Nav.Link onClick={handleCartOpen} title="Carrito">
                <svg className="trash-icon" width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <g clip-path="url(#clip0_1797_1614)">
                  <path d="M8.99543 22.5302C9.39476 24.9944 11.4167 26.8675 13.9121 27.0305C18.8785 27.3536 24.1954 26.7814 29.1983 27.0239C30.2417 27.1148 30.2417 28.4372 29.1983 28.5271C24.1607 28.2433 18.721 28.8989 13.7302 28.5234C10.4268 28.2752 8.09833 25.7989 7.52089 22.6454C6.3482 16.2393 5.97793 9.51563 4.7818 3.09167C4.45559 2.28341 3.74972 1.64186 2.85357 1.55288C2.06615 1.47327 0.173532 1.91721 0.0122988 0.917887C-0.172369 -0.220049 1.85898 0.00191865 2.57891 0.0487473C6.03511 0.274461 6.471 2.99802 6.66598 5.89296L6.80565 6.03439L32.3874 6.04375C34.4403 6.18143 36.0451 7.86351 35.9992 9.93428C35.9673 11.371 34.7965 16.7441 34.2819 18.1518C33.5113 20.2562 30.97 22.5302 28.634 22.5302H8.99543ZM32.7586 7.54508H6.93314L8.94387 21.0373L28.4503 21.0345C30.4901 20.8379 32.288 19.4161 32.9723 17.498C33.4794 16.0744 34.3437 11.7381 34.4815 10.2031C34.5818 9.09136 33.9556 7.7427 32.7595 7.54508H32.7586Z" fill="white"/>
                  <path d="M13.4742 33.0198C13.4742 34.6654 12.1384 36 10.4914 36C8.84434 36 7.50854 34.6654 7.50854 33.0198C7.50854 31.3743 8.84434 30.0396 10.4914 30.0396C12.1384 30.0396 13.4742 31.3743 13.4742 33.0198ZM12.0015 33.0217C12.0015 32.1891 11.3256 31.5138 10.4923 31.5138C9.65895 31.5138 8.98308 32.1891 8.98308 33.0217C8.98308 33.8543 9.65895 34.5296 10.4923 34.5296C11.3256 34.5296 12.0015 33.8543 12.0015 33.0217Z" fill="white"/>
                  <path d="M28.4727 33.0198C28.4727 34.6654 27.1369 36 25.4899 36C23.8429 36 22.5071 34.6654 22.5071 33.0198C22.5071 31.3743 23.8429 30.0396 25.4899 30.0396C27.1369 30.0396 28.4727 31.3743 28.4727 33.0198ZM27 33.0217C27 32.1891 26.3242 31.5138 25.4908 31.5138C24.6575 31.5138 23.9816 32.1891 23.9816 33.0217C23.9816 33.8543 24.6575 34.5296 25.4908 34.5296C26.3242 34.5296 27 33.8543 27 33.0217Z" fill="white"/>
                  </g>
                  <defs>
                  <clipPath id="clip0_1797_1614">
                  <rect width="36" height="36" fill="white"/>
                  </clipPath>
                  </defs>
                </svg>
                {cart.length > 0 && (
                  <span className="ms-1 badge bg-danger rounded-pill">
                    {cart.length}
                  </span>
                )}
              </Nav.Link>
            </Nav>

            {/* Usuario */}
            <Nav>
              {!user ? (
                <>
                  <Button
                    variant="outline-primary"
                    className="me-2 user-iniciar"
                    onClick={() => navigate("/login")}
                  >
                    Iniciar sesión
                  </Button>
                  <button
                    className="user-button"
                    onClick={() => navigate("/register")}
                  >
                    Registrarse
                  </button>
                </>
              ) : (
               <Dropdown align="end">
                <Dropdown.Toggle
                  variant="outline-secondary"
                  id="dropdown-user"
                  className="d-flex sans-regular user-button"
                  bsPrefix="btn"
                >
                  <svg className="trash-icon-user me-2" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10.323 19.657C7.4392 19.657 4.55488 19.657 1.67113 19.657C1.08581 19.657 0.996075 19.5679 1.00013 18.9924C1.02329 15.5592 3.38019 12.3275 6.6362 11.2426C7.58799 10.9253 8.556 10.7516 9.55816 10.7725C10.4926 10.7921 11.4397 10.7285 12.358 10.8622C15.5914 11.3323 17.8302 13.1323 19.0906 16.1382C19.4814 17.0703 19.6626 18.0551 19.6545 19.07C19.651 19.51 19.5086 19.6564 19.0616 19.6564C16.1489 19.6576 13.2356 19.657 10.323 19.657ZM1.89634 18.7515H18.7924C18.7247 18.3289 18.6905 17.9254 18.5938 17.5375C17.8921 14.7284 16.1651 12.8387 13.4012 11.9888C11.6198 11.4412 9.75732 11.488 7.95447 11.8267C5.1813 12.3478 3.31072 14.0464 2.30161 16.676C2.05034 17.3314 1.90908 18.0215 1.89634 18.7515Z" fill="#045B47" stroke="#045B47" stroke-width="0.5" stroke-miterlimit="10"/>
                    <path d="M10.3132 9.88167C7.88917 9.88573 5.88484 7.8953 5.87674 5.47471C5.86805 3.00028 7.83996 1.00348 10.2959 1.00001C12.7906 0.995954 14.7746 2.96322 14.7764 5.44229C14.7781 7.89414 12.7836 9.87762 10.3132 9.88167ZM6.77758 5.4145C6.77585 7.39508 8.35927 8.99183 10.3265 8.99298C12.2822 8.99414 13.872 7.40377 13.8749 5.44402C13.8778 3.46807 12.2921 1.88406 10.3109 1.88406C8.3697 1.88406 6.7799 3.4727 6.77758 5.4145Z" fill="#045B47" stroke="#045B47" stroke-width="0.5" stroke-miterlimit="10"/>
                  </svg>
                  <span>Hola, {userName}!</span>
                </Dropdown.Toggle>
                <Dropdown.Menu>
                  <Dropdown.Item as={Link} to="/profile">
                    Mi perfil
                  </Dropdown.Item>
                  <Dropdown.Item as={Link} to="/profile/orders">
                    Mis pedidos
                  </Dropdown.Item>
                  <Dropdown.Divider />
                  <Dropdown.Item onClick={handleLogout}>
                    Cerrar sesión
                  </Dropdown.Item>
                </Dropdown.Menu>
              </Dropdown>
              )}
            </Nav>
          </Navbar.Collapse>
        </Container>
      </Navbar>

      {/* 🛒 Drawer del carrito */}
      <CartDrawer show={showCart} handleClose={handleCartClose} />

      {/* ☰ Offcanvas lateral del menú (mobile) */}
      <Offcanvas show={showMenu} onHide={handleMenuClose} placement="end">
        <Offcanvas.Header closeButton>
          <Offcanvas.Title>Menú</Offcanvas.Title>
        </Offcanvas.Header>
        <Offcanvas.Body>
          <Nav className="flex-column">
            <Nav.Link 
              as={Link} 
              to="/" 
              onClick={handleMenuClose} 
              className={isActive("/") ? "apple-garamond-bold" : "apple-garamond-light"}
            >
              Inicio
            </Nav.Link>
            <Nav.Link 
              as={Link} 
              to="/products" 
              onClick={handleMenuClose} 
              className={isActive("/products") ? "apple-garamond-bold" : "apple-garamond-light"}
            >
              Productos
            </Nav.Link>

            <hr />

            {!user ? (
              <>
                <Button
                  variant="outline-primary"
                  className="mb-2"
                  onClick={() => {
                    navigate("/login");
                    handleMenuClose();
                  }}
                >
                  Iniciar sesión
                </Button>
                <Button
                  variant="primary"
                  onClick={() => {
                    navigate("/register");
                    handleMenuClose();
                  }}
                >
                  Registrarse
                </Button>
              </>
            ) : (
              <>
                <Nav.Link as={Link} to="/profile" onClick={handleMenuClose}>
                  Mi perfil
                </Nav.Link>
                <Nav.Link
                  as={Link}
                  to="/profile/orders"
                  onClick={handleMenuClose}
                >
                  Mis pedidos
                </Nav.Link>
                <Button
                  variant="outline-danger"
                  className="mt-3"
                  onClick={async () => {
                    await logout();
                    handleMenuClose();
                    navigate("/");
                  }}
                >
                  Cerrar sesión
                </Button>
              </>
            )}
          </Nav>
        </Offcanvas.Body>
      </Offcanvas>
    </>
  );
};

export default AppNavbar;